import{_ as o}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as n,o as r,c as d,a as e,d as i,b as a,w as u,e as t}from"./app-DTZImb1p.js";const c={},p=e("h2",{id:"use-a-local-sui-repo",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#use-a-local-sui-repo"},[e("span",null,"Use a local Sui repo")])],-1),m=e("p",null,"If you build often, then repeating local file access is obviously faster than remote (and more reliable).",-1),b=e("p",null,'If you use the Rust SDK, replace your "git" dependencies with "path".',-1),h=e("p",null,'For Move dependencies replace "git" dependencies with "local".',-1),v=t('<h2 id="build-only-what-you-need" tabindex="-1"><a class="header-anchor" href="#build-only-what-you-need"><span>Build only what you need</span></a></h2><p>If you care only for the client, then do not build the whole thing.<br> Do <code>cargo build -p sui</code> instead of <code>cargo build</code></p><h2 id="parallel-linker" tabindex="-1"><a class="header-anchor" href="#parallel-linker"><span>Parallel Linker</span></a></h2><p>Some build steps are not optimized for parallelism. Notably, you can see this with <code>top</code> on Linux (by pressing <kbd>1</kbd>) and you will see only one core busy while the linker is running.</p>',4),g=e("em",null,"may",-1),f={href:"https://github.com/rui314/mold",target:"_blank",rel:"noopener noreferrer"},y=t(`<p>After installation, you can enable for Rust by creating a <code>config.toml</code>. The following was verified to work for Sui built on Ubuntu:</p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>$ cat ~/.cargo/config.toml
[target.x86_64-unknown-linux-gnu]
rustflags = [&quot;-C&quot;, &quot;link-arg=-fuse-ld=mold&quot;]
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The performance gain varies widely, you have to try for yourself. Do not expect 10x faster... it accelerates only the link phase. Furthermore, the performance gap versus more recent GNU/LLVM linker release is closing.</p><h2 id="how-does-my-build-time-compare" tabindex="-1"><a class="header-anchor" href="#how-does-my-build-time-compare"><span>How does my build time compare?</span></a></h2><p>See some profiling below.</p><p>Measurements are for clean build of sui and sui-faucet only.</p><details class="hint-container details"><summary>Steps for measuring</summary><p>With suibase, do the following to get one measurement:</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>$ localnet delete
$ localnet update
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>If you do not have suibase, then do the following for the first measurements:</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>$ <span class="token function">git</span> clone <span class="token parameter variable">-b</span> devnet https://github.com/MystenLabs/sui.git
$ <span class="token builtin class-name">cd</span> sui
$ <span class="token function">cargo</span> build <span class="token parameter variable">--bin</span> sui <span class="token parameter variable">--bin</span> sui-faucet
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>... and get additional measurements with:</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>$ <span class="token function">cargo</span> clean
$ <span class="token function">cargo</span> build <span class="token parameter variable">--bin</span> sui <span class="token parameter variable">--bin</span> sui-faucet
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></details><p><strong>Modern Linux</strong><br></p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>Low : Finished dev [unoptimized + debuginfo] target(s) in 2m 55s
High: Finished dev [unoptimized + debuginfo] target(s) in 2m 55s

Intel i7-13700K (16 Cores), 64 GB, NVMe PCIe 4
Ubuntu 22.10, Sui 0.31.2
Suibase 0.1.2
GCC 12.2 / Mold 1.11
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>M1 MAX macosx</strong><br></p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>Low : Finished dev [unoptimized + debuginfo] target(s) in 4m 23
High: Finished dev [unoptimized + debuginfo] target(s) in 4m 24s

Apple M1 Max
macOS Ventura 13.3.1 (22E261), Sui 0.31.2
Suibase 0.1.2
Apple clang version 14.0.3
rustc 1.68.2
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Old Server (~2013) Windows 10 WSL2</strong><br></p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>Low : Finished dev [unoptimized + debuginfo] target(s) in 8m 06s
High: Finished dev [unoptimized + debuginfo] target(s) in 8m 20s

2xIntel Xeon E5-2697v2@2.7GHz(24 Cores), 64 GB, NVMe PCIe 3
WSL2 config: 32 VCore, 48 GB
Ubuntu 22.04, Sui 0.31.2
Suibase 0.1.2
GCC 11.3 / Mold 1.11
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,13);function k(x,_){const s=n("RouteLink"),l=n("ExternalLinkIcon");return r(),d("div",null,[p,m,b,h,e("p",null,[i("For suibase users, see "),a(s,{to:"/how-to/scripts.html#faster-rust-and-move-build"},{default:u(()=>[i("here")]),_:1}),i(" to re-use its local repo already downloaded.")]),v,e("p",null,[i("One trick that "),g,i(" help is the parallel linker "),e("a",f,[i("Mold"),a(l)]),i(".")]),y])}const L=o(c,[["render",k],["__file","build.html.vue"]]),M=JSON.parse('{"path":"/cookbook/guides/build.html","title":"Build Faster","lang":"en-US","frontmatter":{"title":"Build Faster","order":3,"contributors":true,"editLink":true,"description":"Use a local Sui repo If you build often, then repeating local file access is obviously faster than remote (and more reliable). If you use the Rust SDK, replace your \\"git\\" depend...","head":[["meta",{"property":"og:url","content":"https://suibase.io/cookbook/guides/build.html"}],["meta",{"property":"og:site_name","content":"suibase.io"}],["meta",{"property":"og:title","content":"Build Faster"}],["meta",{"property":"og:description","content":"Use a local Sui repo If you build often, then repeating local file access is obviously faster than remote (and more reliable). If you use the Rust SDK, replace your \\"git\\" depend..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2023-12-05T17:51:08.000Z"}],["meta",{"property":"article:author","content":"suibase.io"}],["meta",{"property":"article:modified_time","content":"2023-12-05T17:51:08.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Build Faster\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2023-12-05T17:51:08.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"suibase.io\\",\\"url\\":\\"https://suibase.io\\"}]}"]]},"headers":[{"level":2,"title":"Use a local Sui repo","slug":"use-a-local-sui-repo","link":"#use-a-local-sui-repo","children":[]},{"level":2,"title":"Build only what you need","slug":"build-only-what-you-need","link":"#build-only-what-you-need","children":[]},{"level":2,"title":"Parallel Linker","slug":"parallel-linker","link":"#parallel-linker","children":[]},{"level":2,"title":"How does my build time compare?","slug":"how-does-my-build-time-compare","link":"#how-does-my-build-time-compare","children":[]}],"git":{"createdTime":1681438739000,"updatedTime":1701798668000,"contributors":[{"name":"mario4tier","email":"mario4tier@users.noreply.github.com","commits":4},{"name":"Frank V. Castellucci","email":"frankiecast@gmail.com","commits":2}]},"readingTime":{"minutes":1.5,"words":450},"filePathRelative":"cookbook/guides/build.md","localizedDate":"April 14, 2023","autoDesc":true}');export{L as comp,M as data};
